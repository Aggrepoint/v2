var IBUtils={setClass:function(b,a){b.className=a;b.setAttribute("class",a)},evtSrcElement:function(a){a=a?a:(window.event?window.event:null);return a.srcElement?a.srcElement:a.target},isContains:function(c,a){var b=(c==a);while(!b&&a.parentNode!=null&&a.parentNode!=a){a=a.parentNode;b=(c==a)}return b},addMouseOver:function(b,a){if(b.m_arrOnMouseOver==null){b.m_arrOnMouseOver=new Array();b.onmouseover=function(c){var d;for(d=0;d<this.m_arrOnMouseOver.length;d++){this.m_arrOnMouseOver[d](this,c)}}}b.m_arrOnMouseOver[b.m_arrOnMouseOver.length]=a},addMouseOut:function(b,a){if(b.m_arrOnMouseOut==null){b.m_arrOnMouseOut=new Array();b.onmouseout=function(c){var d;for(d=0;d<this.m_arrOnMouseOut.length;d++){this.m_arrOnMouseOut[d](this,c)}}}b.m_arrOnMouseOut[b.m_arrOnMouseOut.length]=a},addMouseDown:function(b,a){if(b.m_arrOnMouseDown==null){b.m_arrOnMouseDown=new Array();b.onmousedown=function(c){var d;for(d=0;d<this.m_arrOnMouseDown.length;d++){this.m_arrOnMouseDown[d](this,c)}}}b.m_arrOnMouseDown[b.m_arrOnMouseDown.length]=a},addMouseUp:function(b,a){if(b.m_arrOnMouseUp==null){b.m_arrOnMouseUp=new Array();b.onmouseup=function(c){var d;for(d=0;d<this.m_arrOnMouseUp.length;d++){this.m_arrOnMouseUp[d](this,c)}}}b.m_arrOnMouseUp[b.m_arrOnMouseUp.length]=a},addClick:function(b,a){if(b.m_arrOnClick==null){b.m_arrOnClick=new Array();b.onclick=function(c){var d;for(d=0;d<this.m_arrOnClick.length;d++){this.m_arrOnClick[d](this,c)}}}b.m_arrOnClick[b.m_arrOnClick.length]=a},attachCal:function(e,c,b,d,a){if(!e.selector){e=$(e)}e.each(function(f){if(this.m_calsel==null){new IBCalSel(this,c,b,d,a)}})},invokeFunc:function(func){var code=func;code+="(";for(var i=1;i<arguments.length;i++){if(i!=1){code+=", "}code+='"';code+=escape(arguments[i]);code+='"'}code+=");";return function(){eval(code)}}};var IBCMenu={menuClickFunc:function(a){return function(c,b){IBCMenu.menuClick(IBUtils.evtSrcElement(b),c,a)}},menuClick:function(c,a,b){if(c==null||c==a){return}if(c.m_option!=null){if(c.m_option.type=="option"){if(c.m_option.sub==null||b){if(a.m_cascadedMenu.onSelect!=null){a.m_cascadedMenu.onSelect(c.m_option.value)}a.m_cascadedMenu.hide()}}return}if(c.parentNode!=null&&c.parentNode!=c){IBCMenu.menuClick(c.parentNode,a,b)}},menuMouseOverFunc:function(){return function(b,a){IBCMenu.menuMouseOver(IBUtils.evtSrcElement(a),b)}},menuMouseOver:function(b,a){a.m_overTime=new Date().getTime();if(b==null||b==a){return}if(b.m_option!=null&&(b.m_option.type=="option"||b.m_option.type=="sub")){if(b.m_menu.m_lastHighLight!=null){if(b.m_menu.m_lastHighLight==b){return}IBUtils.setClass(b.m_menu.m_lastHighLight,"normal");if(b.m_menu.m_lastHighLight.m_sub!=null){b.m_menu.m_lastHighLight.m_sub.hide()}b.m_menu.m_lastHighLight=null}IBUtils.setClass(b,"highlight");if(b.m_sub!=null){b.m_sub.show()}b.m_menu.m_lastHighLight=b;return}if(b.parentNode!=null&&b.parentNode!=b){IBCMenu.menuMouseOver(b.parentNode,a)}},menuMouseOutFunc:function(){return function(b,a){IBCMenu.menuMouseOut(IBUtils.evtSrcElement(a),b)}},checkClose:function(a){return function(){if(a.m_outTime>a.m_overTime){a.m_cascadedMenu.hide()}}},menuMouseOut:function(b,a){a.m_outTime=new Date().getTime();setTimeout(IBCMenu.checkClose(a),100)},setOptionsParent:function(a,c){if(a==null){return}var b;for(b=0;b<a.length;b++){if(a[b].oparent==null){a[b].oparent=c;if(a[b].sub){IBCMenu.setOptionsParent(a[b].sub,a[b])}}}},clickElsewhere:function(a){if(IBCMenu.currentMenu){if(!IBUtils.isContains(IBCMenu.currentMenu.m_holderElm,IBUtils.evtSrcElement(a))){IBCMenu.currentMenu.hide()}}},attach:function(g,b,f,e,d,c,a){if(!this.inited){$(document).mousedown(this.clickElsewhere);this.inited=true}if(g.m_cascadedMenu!=null){return}new IBCascadedMenu(g,b,f,e,d,true,c,a)}};function IBCascadedMenu(a,f,h,g,e,c,d,b){this.m_holderElm=a;this.m_iconRoot=h;this.m_arrOptions=f;this.m_className=e||"cmenu";this.m_isRoot=c;if(c){this.onSelect=d;this.onHide=b;IBCMenu.setOptionsParent(this.m_arrOptions,null);IBUtils.addClick(a,IBCMenu.menuClickFunc(g));IBUtils.addMouseOver(a,IBCMenu.menuMouseOverFunc());IBUtils.addMouseOut(a,IBCMenu.menuMouseOutFunc())}a.m_cascadedMenu=this;this.complete()}IBCascadedMenu.prototype.complete=function(){this.m_div=document.createElement("div");this.m_div.style.position="absolute";this.m_div.style.zIndex=1000;this.m_div.style.display="none";this.m_holderElm.appendChild(this.m_div);var c=document.createElement("table");c.cellSpacing="0";c.cellPadding="0";c.cellSpacing="0";c.border="0";IBUtils.setClass(c,this.m_className);this.m_div.appendChild(c);var a=document.createElement("tbody");c.appendChild(a);var b;for(b=0;b<this.m_arrOptions.length;b++){this.completeOption(this.m_arrOptions[b],a)}return this};IBCascadedMenu.prototype.completeOption=function(c,b){var d=document.createElement("tr");d.m_option=c;d.m_menu=this;var e;var a;if(c.type=="sep"){e=document.createElement("td");IBUtils.setClass(e,"line");d.appendChild(e);e=document.createElement("td");IBUtils.setClass(e,"line");e.colSpan="2";d.appendChild(e);b.appendChild(d);return}if(c.type=="label"){e=document.createElement("td");IBUtils.setClass(e,"text");e.colSpan="3";e.noWrap=true;e.appendChild(document.createTextNode(c.label));d.appendChild(e);b.appendChild(d);return}IBUtils.setClass(d,"normal");e=document.createElement("td");IBUtils.setClass(e,"img");e.noWrap=true;if(c.logo==null){e.appendChild(document.createTextNode(" "))}else{var a=document.createElement("img");a.border="0";if(this.m_iconRoot!=null&&this.m_iconRoot!=""){a.src=this.m_iconRoot+c.logo}else{a.src=c.logo}e.appendChild(a)}d.appendChild(e);e=document.createElement("td");e.noWrap=true;if(c.tip!=null&&c.tip!=""){abbr=document.createElement("abbr");abbr.title=c.tip;abbr.appendChild(document.createTextNode(c.label));e.appendChild(abbr)}else{e.appendChild(document.createTextNode(c.label))}d.appendChild(e);if(c.sub==null){e=document.createElement("td");e.noWrap=true;e.appendChild(document.createTextNode(" "))}else{e=document.createElement("td");e.noWrap=true;IBUtils.setClass(e,"expand");e.appendChild(document.createTextNode("}"));d.m_sub=new IBCascadedMenu(e,c.sub,this.m_iconRoot,false,this.m_className,false).complete()}d.appendChild(e);b.appendChild(d)};IBCascadedMenu.prototype.show=function(){if(this.m_div.style.display=="block"){return}var f=$(this.m_holderElm).position();var k=0;var c=0;if(this.m_isRoot){if(IBCMenu.currentMenu){IBCMenu.currentMenu.hide()}IBCMenu.currentMenu=this;if(arguments.length==2){k=arguments[1];c=arguments[0];this.m_div.style.top=k+"px";this.m_div.style.left=c+"px"}else{k=f.top+this.m_holderElm.offsetHeight;c=f.left;this.m_div.style.top=k+"px";this.m_div.style.left=c+"px"}}else{k=$(this.m_holderElm).position().top;c=$(this.m_holderElm).position().left+this.m_holderElm.offsetWidth-1;this.m_div.style.top=k+"px";this.m_div.style.left=c+"px"}this.m_div.style.display="block";try{var o=document.documentElement;var h=$(this.m_div);var q=h.offset().top;var d=h.offset().left;var m=q+h[0].offsetHeight;var a=d+h[0].offsetWidth;var n=0;if(o.scrollTop+o.clientHeight<m){n=m-o.scrollTop-o.clientHeight}if(o.scrollTop+n>q){n=q-o.scrollTop}if(n!=0){this.m_div.style.top=(k-n)+"px"}var p=0;if(o.scrollLeft+o.clientWidth<a){p=a-o.scrollLeft-o.clientWidth}if(o.scrollLeft+p>d){p=d-o.scrollLeft}if(p!=0){this.m_div.style.left=(c-p)+"px"}}catch(g){}};IBCascadedMenu.prototype.hide=function(){if(IBCMenu.currentMenu==this){IBCMenu.currentMenu=null}this.m_div.style.display="none";if(this.onHide!=null){this.onHide()}};IBCascadedMenu.prototype.getOptionByValue=function(a,d){var c;if(a==null){a=this.m_arrOptions}if(a==null){return null}for(c=0;c<a.length;c++){if(a[c].value==d){return a[c]}if(a[c].sub!=null){var b=this.getOptionByValue(a[c].sub,d);if(b!=null){return b}}}return null};var IconSel={updateIconSel:function(e,a,d){var b=e.m_cascadedMenu.getOptionByValue(null,d);if(b!=null){var c="";while(b!=null&&(b.type=="option"||c!=""&&b.type=="sub")){if(c!=""){c=" - "+c}if(b.logo==null){c=b.label+c}else{if(e.m_cascadedMenu.m_iconRoot!=null&&e.m_cascadedMenu.m_iconRoot!=""){c='<img border=0 align=absmiddle src="'+e.m_cascadedMenu.m_iconRoot+b.logo+'"> '+b.label+c}else{c='<img border=0 align=absmiddle src="'+b.logo+'"> '+b.label+c}}b=b.oparent}if(c!=""){a.innerHTML=c}}},iconSelSelected:function(c,a,b){return function(d){IconSel.updateIconSel(c,a,d);if(b!=null){b.value=d}c.m_cascadedMenu.hide();if(c.onchange!=null){c.onchange(d)}}},attach:function(g,c,a,f,e,b,d){if(!g.selector){g=$(g)}g.each(function(k){if(this.m_cascadedMenu==null){new IBCascadedMenu(this,c,f,e,a,true);this.m_input=d;var h=null;var k;for(k=0;k<this.childNodes.length;k++){if(this.childNodes[k].tagName=="SPAN"&&this.childNodes[k].id=="menu"){h=this.childNodes[k];break}}if(h==null){h=document.createElement("span");this.appendChild(h)}IconSel.updateIconSel(this,h,b);if(d!=null){d.value=b}this.onSelect=IconSel.iconSelSelected(this,h,d)}})}};var IBWink={doWink:function(f,c,b){if(c==null){return}try{var a=c.getAttribute("class");if(a==null){a=c.className}if(a!=null&&a!=""&&a.indexOf("__")!=-1){className=a.substr(0,a.indexOf("__")+2)+b;c.className=className;c.setAttribute("class",className)}if(c==f||c.parentNode==null||c.parentNode==c){return}IBWink.doWink(f,c.parentNode,b)}catch(d){}},setWinkFunc:function(a){return function(c,b){IBWink.doWink(c,IBUtils.evtSrcElement(b),a)}},attach:function(a){IBUtils.addMouseOver(a,IBWink.setWinkFunc("over"));IBUtils.addMouseOut(a,IBWink.setWinkFunc("normal"));IBUtils.addMouseDown(a,IBWink.setWinkFunc("down"));IBUtils.addMouseUp(a,IBWink.setWinkFunc("over"))}};$(document).ready(function(){IBWink.attach($("body")[0])});var IBCal={m_arrMonthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],m_tmplCalendar:'<table border="0" cellspacing="0" cellpadding="2" class="cal"><tr><td nowrap><span class="button__normal" id="prevyear"><img border="0" src="_BASE_/left.gif" align=absmiddle></span> _YEAR_ <span class="button__normal" id="nextyear"><img border="0" src="_BASE_/right.gif" align=absmiddle></span></td><td align="right" nowrap><span class="button__normal" id="prevmonth"><img border="0" src="_BASE_/left.gif" align=absmiddle></span> _MONTH_ <span class="button__normal" id="nextmonth"><img border="0" src="_BASE_/right.gif" align=absmiddle></span></td></tr><tr><td colspan="2"><table class="content" border="0" cellspacing="0" cellpadding="5"><tr	align="center" class="headline"><td>日</td><td>一</td><td>二</td><td>三</td><td>四</td><td>五</td><td>六</td></tr>_ROW_</table></td></tr></table>',m_tmplRow:'<tr align="center">_CELL_</tr>',m_tmplCell:'<td class="btnhide__normal" id="day">_DAY_</td>',m_tmplCellSelected:'<td class="btnsel__normal" id="day">_DAY_</td>',m_tmplCellEmpty:"<td>&nbsp;</td>",calClick:function(a,b){if(a.id=="prevyear"){b.prevYear();return}else{if(a.id=="nextyear"){b.nextYear();return}else{if(a.id=="prevmonth"){b.prevMonth();return}else{if(a.id=="nextmonth"){b.nextMonth();return}else{if(a.id=="day"){b.setDay(a.childNodes[0].data);return}}}}}if(a==b.m_elm||a.parentNode==null||a.parentNode==a){return}IBCal.calClick(a.parentNode,b)},calClickFunc:function(a){return function(b){IBCal.calClick(IBUtils.evtSrcElement(b),a)}},getDaysInMonth:function(a,c){var b;switch(c){case 1:case 3:case 5:case 7:case 8:case 10:case 12:b=31;break;case 2:if(0==a%4){b=29;if((0==a%100)&&(0!=a%8)){b=28}}else{b=28}break;default:b=30}return b},packAllSpace:function(e){var c,d;var b,a;c="";a=e.length;for(b=0;b<a;b++){if(e.charAt(b)!=" "){c=c+e.charAt(b)}}return c},calHideDelay:function(b,a){return function(){if(a>b.m_showTime){b.hide()}}}};function IBCalSel(e,c,b,d,a){this.m_elm=e;this.m_date=new Date();if(c!=null&&c!=""){this.m_format=c}else{this.m_format="y-m-d"}this.m_baseurl=d;this.onValueChanged=a;this.m_div=document.createElement("div");this.m_div.style.position="absolute";this.m_div.style.display="none";this.m_div.className=b;this.m_div.setAttribute("class",b);this.m_div.onclick=IBCal.calClickFunc(this);e.appendChild(this.m_div);e.m_calsel=this;this.m_showTime=0;IBUtils.addMouseOver(this.m_div,function(f){f.parentNode.m_calsel.m_showTime=new Date().getTime()});IBUtils.addMouseOut(this.m_div,function(f){setTimeout(IBCal.calHideDelay(f.parentNode.m_calsel,new Date().getTime()),100)})}IBCalSel.prototype.getDate=function(){var g="y-m-d";if(this.m_format!=null){g=this.m_format}var f="";var e;var b,c;g=IBCal.packAllSpace(g);c=g.length;j=0;for(b=0;b<c;b++){e=g.charAt(b);if(e=="Y"||e=="y"){f=f+this.m_date.getFullYear()}else{if(e=="m"){f=f+(this.m_date.getMonth()+1)}else{if(e=="M"){var a=this.m_date.getMonth()+1;if(a<10){f=f+"0"+a}else{f=f+a}}else{if(e=="d"){f=f+(this.m_date.getDate())}else{if(e=="D"){var h=this.m_date.getDate();if(h<10){f=f+"0"+h}else{f=f+h}}else{f=f+e}}}}}}return f};IBCalSel.prototype.setDate=function(n){try{var o="y-m-d";if(this.m_format!=null){o=this.m_format}var h,d,c;var l,g,f,a,b;strDate=IBCal.packAllSpace(n);o=IBCal.packAllSpace(o);b=strDate.length;a=o.length;g=0;for(l=0;l<a;l++){d=o.charAt(l);if(d=="Y"||d=="y"){h="";for(f=0;f<4;f++){c=strDate.charAt(g);if(c<"0"||c>"9"){break}g++;h=h+c}if(f==0){return false}iYear=parseInt(h);if(d=="Y"){if(iYear<30){iYear=iYear+2000}else{if(iYear<100){iYear=iYear+1900}}}this.m_date.setFullYear(iYear)}else{if(d=="M"||d=="m"){h="";for(f=0;f<2;f++){c=strDate.charAt(g);if(c<"0"||c>"9"){break}g++;if(!(h==""&&c=="0")){h=h+c}}if(f==0){return false}iMonth=parseInt(h);if(iMonth>12){iMonth=12}else{if(iMonth<1){iMonth=1}}this.m_date.setMonth(iMonth-1)}else{if(d=="D"||d=="d"){h="";for(f=0;f<2;f++){c=strDate.charAt(g);if(c<"0"||c>"9"){break}g++;if(!(h==""&&c=="0")){h=h+c}}if(f==0){return false}iDay=parseInt(h);iMaxDay=IBCal.getDaysInMonth(this.m_date.getFullYear(),this.m_date.getMonth()+1);if(iDay<1){iDay=1}if(iDay>iMaxDay){iDay=iMaxDay}this.m_date.setDate(iDay)}else{c=strDate.charAt(g);g++;if(c!=d){return false}}}}}}catch(m){}return true};IBCalSel.prototype.show=function(){var g=this.m_date.getFullYear();var d=this.m_date.getMonth();var h=this.m_date.getDate();var f=IBCal.m_tmplCalendar.replace("_MONTH_",IBCal.m_arrMonthNames[d]);f=f.replace("_YEAR_",g+"年");var k=new Date(g,d,1);var a=IBCal.getDaysInMonth(g,d+1);var b=k.getDay();var e="";for(i=0;i<b;i++){e=e+IBCal.m_tmplCellEmpty}for(i=1;i<=a;i++){if(i==h){e=e+IBCal.m_tmplCellSelected.replace(/_DAY_/g,i)}else{e=e+IBCal.m_tmplCell.replace(/_DAY_/g,i)}b++;if(b==7){f=f.replace("_ROW_",IBCal.m_tmplRow.replace("_CELL_",e)+"_ROW_");b=0;e=""}}if(b!=0){for(i=b;i<7;i++){e=e+IBCal.m_tmplCellEmpty}f=f.replace("_ROW_",IBCal.m_tmplRow.replace("_CELL_",e)+"_ROW_")}f=f.replace("_ROW_","");f=f.replace(/_BASE_/g,this.m_baseurl);this.m_div.innerHTML=f;var c=$(this.m_elm).position();this.m_div.style.top=(c.top+this.m_elm.offsetHeight)+"px";this.m_div.style.left=c.left+"px";this.m_div.style.display="block"};IBCalSel.prototype.hide=function(){this.m_div.style.display="none"};IBCalSel.prototype.setDay=function(a){this.m_date.setDate(a);if(this.onValueChanged!=null){this.onValueChanged(this.getDate())}this.hide()};IBCalSel.prototype.prevMonth=function(){var a=this.m_date.getFullYear();var b=this.m_date.getMonth();if(b==0){this.m_date.setMonth(11);this.m_date.setFullYear(a-1)}else{this.m_date.setMonth(b-1)}if(this.onValueChanged!=null){this.onValueChanged(this.getDate())}if(this.m_div.style.display=="block"){this.show()}};IBCalSel.prototype.nextMonth=function(){var a=this.m_date.getFullYear();var b=this.m_date.getMonth();if(b==11){this.m_date.setMonth(0);this.m_date.setFullYear(a+1)}else{this.m_date.setMonth(b+1)}if(this.onValueChanged!=null){this.onValueChanged(this.getDate())}if(this.m_div.style.display=="block"){this.show()}};IBCalSel.prototype.prevYear=function(){this.m_date.setFullYear(this.m_date.getFullYear()-1);if(this.onValueChanged!=null){this.onValueChanged(this.getDate())}if(this.m_div.style.display=="block"){this.show()}};IBCalSel.prototype.nextYear=function(){this.m_date.setFullYear(this.m_date.getFullYear()+1);if(this.onValueChanged!=null){this.onValueChanged(this.getDate())}if(this.m_div.style.display=="block"){this.show()}};